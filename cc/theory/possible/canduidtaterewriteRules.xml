<!-- 15 Feb 2017 Reverese rule 5 and undo yesterday and tosday's tempoary generalisations of rules 19, 27 and 29 -->

<algebra>
  <name>cc</name>

  <rewriteRule>
    <id>1</id>
    <lhs>
      <o>
        <id/>
        <var>f</var>
      </o>
    </lhs>
    <rhs>
      <var>f</var>
    </rhs>
  </rewriteRule>


  <rewriteRule>
    <id>2</id>
    <lhs>
      <o>
        <var>f</var>
        <id/>
      </o>
    </lhs>
    <rhs>
      <var>f</var>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>3</id>
    <lhs>
      <o>
        <var>f</var>
        <o>
          <var>g</var>
          <var>h</var>
        </o>
      </o>
    </lhs>
    <rhs>
      <o>
        <o>
          <var>f</var>
          <var>g</var>
        </o>
        <var>h</var>
      </o>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>4r</id>
    <lhs>
      <o>
        <var>f</var>
        <p/>
      </o>
    </lhs>
    <rhs>
      <ft>
        <var>f</var>
      </ft>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>5r</id>
    <lhs>
      <star>
        <o>
          <var>f</var>
          <var>g5</var>
        </o>
        <var>x</var>
      </star>
    </lhs>
    <rhs>
      <star>
        <var>f</var>
        <star>
          <var>g5</var>
          <var>x</var>
        </star>
      </star>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>6rp</id>
    <lhs>
      <q>
        <o>
          <var>f</var>
          <var>g</var>
        </o>
        <var>x</var>
      </q>
    </lhs>
    <rhs>
      <o>
        <q>
          <var>f</var>
          <star>
            <var>g</var>
            <var>x</var>
          </star>
        </q>
        <q>
          <var>g</var>
          <var>x</var>
        </q>
      </o>

    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>7</id>
    <lhs>      
      <star>
        <id/>
        <var>x</var>
      </star>       
    </lhs>
    <rhs>
      <var>x</var>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>8</id>
    <lhs>      
      <q>
        <id/>
        <var>x</var>
      </q>       
    </lhs>
    <rhs>
      <id/>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>9p</id>
    <lhs>
      <ft>
        <q>
          <var>f</var>
          <var>y</var>
        </q>
      </ft>
    </lhs>
    <rhs>
      <o>
        <p/>
        <var>f</var>
      </o>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>10p</id>
    <lhs>
      <ft>
        <s>
          <var>f</var>
        </s>
      </ft>
    </lhs>
    <rhs>
      <id/>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>11pp</id>
    <lhs>
      <o>
        <s>
          <var>fff</var>
        </s>
        <q>
          <ft>
            <var>fff</var>
          </ft>
          <var>yy</var>
        </q>
      </o>
    </lhs>
    <rhs>
      <var>fff</var>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>12</id>
    <lhs>
      <s>
        <o>
          <var>f</var>
          <q>
            <var>g</var>
            <var>z</var>
          </q>
        </o>
      </s>
    </lhs>
    <rhs>
      <s>
        <var>f</var>
      </s>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>13p</id>
    <lhs>
      <ft>
        <o>
          <var>f</var>
          <q>
            <var>g</var>
            <var>y</var>
          </q>
        </o>
      </ft>
    </lhs>
    <rhs>
      <o>
        <ft>
          <var>f</var>
        </ft>
        <var>g</var>
      </o>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>15pp</id>
    <lhs>
      <o>
        <o>
          <var>g</var>
          <s>
            <var>f</var>
          </s>
        </o>
        <q>
          <ft>
            <var>f</var>
          </ft>
          <var>y</var>

        </q>
      </o>
    </lhs>
    <rhs>
      <o>
        <var>g</var>
        <var>f</var>
      </o>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>16p</id>
    <lhs>
      <ft>
        <o>
          <var>g</var>
          <s>
            <var>f</var>
          </s>
        </o>
      </ft>
    </lhs>
    <rhs>
      <var>g</var>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>17</id>
    <lhs>
      <o>
        <s>
          <o>
            <var>f</var>
            <s>
              <var>g17</var>
            </s>
          </o>
        </s>
        <q>
          <var>f</var>
          <star>
            <ft>
              <var>g17</var>
            </ft>
            <var>c</var>
          </star>
        </q>
      </o>    
    </lhs>
    <rhs>
      <o>
        <var>f</var>
        <s>
          <var>g17</var>
        </s>
      </o>
    </rhs>
  </rewriteRule>

  <!-- DERIVATION OF 18 HAD ERROR IN IT - ERROR DISCOVERED 2 FEB 2017 
	<rewriteRule>
		<id>18</id>
		<lhs>
			<s>
				<o>
					<var>f</var>
					<s>
						<var>g</var>
					</s>
				</o>
			</s>
		</lhs>
		<rhs>
			<s>
				<o>
					<var>f</var>
					<var>g</var>
				</o>
			</s>
		</rhs>
	</rewriteRule>
  -->

  <rewriteRule>
    <id>19</id>
    <lhs>
      <o>
        <q>
          <var>f</var>
          <star>
            <p/>
            <var>y</var>
          </star>
        </q>
        <q>
          <p/>
          <var>y</var>
        </q>			
      </o>
    </lhs>
    <rhs>
      <q>
        <ft>
          <var>f</var>
        </ft>
        <var>y</var>
      </q>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>20p</id>
    <lhs>
      <o>
        <var>ff</var>
        <ft>
          <var>gg</var>
        </ft>
      </o>	
    </lhs>
    <rhs>
      <ft>
        <o>
          <var>ff</var>
          <var>gg</var>
        </o>
      </ft>
    </rhs>
  </rewriteRule>

  <!-- FROM cc1 and cc17 -->
  <rewriteRule>
    <id>21</id>
    <lhs>
      <s>
        <s>
          <var>f</var>
        </s>
      </s>	
    </lhs>
    <rhs>
      <s>
        <var>f</var>
      </s>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>22</id>
    <lhs>
      <o>
        <o>
          <var>f</var>
          <q>
            <var>g</var>
            <star>
              <p/>
              <var>y</var>
            </star>
          </q>
        </o>	
        <q>
          <p/>
          <var>y</var>
        </q>
      </o>
    </lhs>
    <rhs>
      <o>
        <var>f</var>
        <q>
          <ft>
            <var>g</var>
          </ft>
          <var>y</var>
        </q>
      </o>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>23</id>
    <lhs>
      <o>			
        <q>
          <var>f</var>
          <star>
            <ft>
              <var>g</var>
            </ft>
            <var>y</var>
          </star>
        </q>
        <q>
          <ft>
            <var>g</var>
          </ft>
          <var>y</var>
        </q>
      </o>	
    </lhs>
    <rhs>
      <q>
        <ft>
          <o>
            <var>f</var>
            <var>g</var>
          </o>
        </ft>
        <var>y</var>
      </q>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>24</id>
    <lhs>
      <o>
        <o>
          <var>f</var>		
          <q>
            <var>g</var>
            <star>
              <ft>
                <var>h</var>
              </ft>
              <var>y</var>
            </star>
          </q>
        </o>
        <q>
          <ft>
            <var>h</var>
          </ft>
          <var>y</var>
        </q>
      </o>	
    </lhs>
    <rhs>
      <o>
        <var>f</var>
        <q>
          <ft>
            <o>
              <var>g</var>
              <var>h</var>
            </o>
          </ft>
          <var>y</var>
        </q>
      </o>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>25</id>
    <!-- from cc1  and cc4r -->
    <lhs>      
      <ft>
        <id/>
      </ft>       
    </lhs>
    <rhs>
      <p/>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>26</id>
    <!-- from cc1  and cc12 -->
    <lhs>      
      <s>
        <q>
          <var>g</var>
          <var>z</var>
        </q>
      </s>       
    </lhs>
    <rhs>
      <s>
        <id/>
      </s>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>27</id>
    <lhs> 
      <o>    
        <q>
          <var>f</var>
          <star>
            <p/>
            <var>c</var>
          </star>
        </q>
        <q>
          <p/>
          <var>c</var>
        </q>
      </o>       
    </lhs>
    <rhs>
      <q>
        <ft>
          <var>f</var>
        </ft>
        <var>c</var>
      </q>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>28</id>
    <lhs>
      <o>
        <s>
          <o>
            <var>f28</var>
            <s>
              <id/>
            </s>
          </o>
        </s>
        <q>
          <var>f28</var>
          <star>
            <p/>
            <var>c</var>
          </star>
        </q>
      </o>    
    </lhs>
    <rhs>
      <o>
        <var>f28</var>
        <s>
          <id/>
        </s>
      </o>
    </rhs>
  </rewriteRule>


  <rewriteRule>
    <id>29</id>
    <lhs> 
      <o>
        <o>
          <var>f</var>     
          <q>
            <var>g</var>
            <star>
              <p/>
              <var>c</var>
            </star>
          </q>
        </o>
        <q>
          <p/>
          <var>c</var>
        </q>
      </o>       
    </lhs>
    <rhs>
      <o>
        <var>f</var>
        <q>
          <ft>
            <var>g</var>
          </ft>
          <var>c</var>
        </q>
      </o>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>30</id>
    <!-- from cc5r -->
    <lhs> 
      <star>     
        <var>f</var>     
        <star>
          <p/>
          <var>x</var>
        </star>
      </star>       
    </lhs>
    <rhs>
      <star>
        <ft>
          <var>f</var>
        </ft>
        <var>x</var>
      </star>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>31</id>
    <!-- from cc30 -->
    <lhs> 
      <star>     
        <var>f</var>     
        <star>
          <ft>
            <var>g</var>
          </ft>
          <var>x</var>
        </star>
      </star>       
    </lhs>
    <rhs>
      <star>
        <ft>
          <o>
            <var>f</var>
            <var>g</var>
          </o>
        </ft>
        <var>x</var>
      </star>
    </rhs>
  </rewriteRule>

  <rewriteRule>
    <id>32</id>
    <!-- from cc19 and cc6rp -->
    <lhs>
      <o>
        <o>
          <var>f</var>
          <q>
            <var>g</var>
            <star>
              <p/>
              <var>y32</var>
            </star>
          </q>
        </o>
        <q>
          <p/>
          <var>y32</var>
        </q>			
      </o>
    </lhs>
    <rhs>
      <o>
        <var>f</var>
        <q>
          <ft>
            <var>g</var>
          </ft>
          <var>y32</var>
        </q>
      </o>
    </rhs>

  </rewriteRule>      
  

</algebra>
